This is a not yet merged pull request, but shows the direction this is heading.